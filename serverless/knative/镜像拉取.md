https://registry.hub.docker.com/r/rancher/activator-2d008c4c36689d255523e5fa210c0bec

 % kubectl -n knative-serving get deploy                  NAME                    READY   UP-TO-DATE   AVAILABLE   AGE
activator               0/1     1            0           8h
autoscaler              0/1     1            0           8h
controller              0/1     1            0           8h
domain-mapping          0/1     1            0           8h
domainmapping-webhook   0/1     1            0           8h
webhook                 0/1     1            0           8h

 % kubectl -n knative-eventing get deploy
NAME                    READY   UP-TO-DATE   AVAILABLE   AGE
eventing-controller     0/1     1            0           8h
eventing-webhook        0/1     1            0           8h
pingsource-mt-adapter   0/0     0            0           8h



% kubectl -n knative-serving get deploy |awk '{print $1}' |grep -v NAME |xargs -I{} kubectl -n knative-serving get deploy {} -o yaml |grep image:
        image: gcr.io/knative-releases/knative.dev/serving/cmd/activator@sha256:ba1485ded12049525afb9856c2fa10d613dbc2b2da90556116bf257f2128eaae
        image: gcr.io/knative-releases/knative.dev/serving/cmd/autoscaler@sha256:dca8258a46dd225b8a72dfe63e8971b23876458f6f64b4ad82792c4d6e470bdc
        image: gcr.io/knative-releases/knative.dev/serving/cmd/controller@sha256:2765feeaa3958827388e6f5119010ee08c0eec9ad7518bb38ac4b9a4355d87fb
        image: gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping@sha256:25df5b854d28dac69c6293db4db50d8fa819c96ad2f2a30bdde6aad467de1b17
        image: gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping-webhook@sha256:6ccc1f6ac07d27e97d96c502b4c6e928d5fb3abd165ae7670e94a57788416c75
        image: gcr.io/knative-releases/knative.dev/serving/cmd/webhook@sha256:9f3c83def9d0d5de0e8e1d1f4c10f262e283fe12d21dcbb91de06b65d3bd08ad


% kubectl -n knative-eventing get deploy |awk '{print $1}' |grep -v NAME |xargs -I{} kubectl -n knative-eventing get deploy {} -o yaml |grep image:
        image: gcr.io/knative-releases/knative.dev/eventing/cmd/controller@sha256:14e565af0a741a0e34b139d9661555189972af8d53e837305f711a3f9025e188
        image: gcr.io/knative-releases/knative.dev/eventing/cmd/webhook@sha256:9ca667c4d9c9c02b1549aee6d3fc13f40e8e54322260525665b029983c373ece
        image: gcr.io/knative-releases/knative.dev/eventing/cmd/mtping@sha256:6a78d2df8eec44bb983ae39952097670fad0556afc6d069fc88fd8347a014698

https://www.cnblogs.com/xiaoqi/p/gcr-io-and-k8s-gcr-io.html

anjia0532 
docker pull anjia0532/knative-releases/knative.dev/eventing/cmd/controller@sha256:14e565af0a741a0e34b139d9661555189972af8d53e837305f711a3f9025e188


% docker pull rancher/activator-2d008c4c36689d255523e5fa210c0bec:latest
latest: Pulling from rancher/activator-2d008c4c36689d255523e5fa210c0bec
e8d8785a314f: Pull complete
45e913e4d7fc: Pull complete
bf3c28f87bce: Pull complete
Digest: sha256:87bc630c2005bf3a10c22248a940237a4291568ab6904c392998877e00228a75
Status: Downloaded newer image for rancher/activator-2d008c4c36689d255523e5fa210c0bec:latest
docker.io/rancher/activator-2d008c4c36689d255523e5fa210c0bec:latest

% docker tag docker.io/rancher/activator-2d008c4c36689d255523e5fa210c0bec:latest  gcr.io/knative-releases/knative.dev/serving/cmd/activator@sha256:ba1485ded12049525afb9856c2fa10d613dbc2b2da90556116bf257f2128eaae
refusing to create a tag with a digest reference

 Warning  Failed     4s (x8 over 70s)  kubelet            Error: container has runAsNonRoot and image will run as root

 https://blog.csdn.net/fly910905/article/details/105356297/


上面的镜像地址是带 digest 引用的，直接用 Docker tag 其实是解决不了问题的，如下会报refusing to create a tag with a digest reference的错误：
利用 Docker Hub ，可在国内 pull，但它同时能拉取国外镜像的特点，选择在 Docker Hub 上构建一个以目标镜像为 base 镜像的方式，然后将上面 release-lite.yaml 上的目标镜像替换为在 Docker HUb 上建立的镜像地址即可。如下为一个 Dockerfile 的示例：

FROM gcr.io/knative-releases/github.com/knative/build/cmd/webhook@sha256:58775663a5bc0d782c8505a28cc88616a5e08115959dc62fa07af5ad76c54a97
MAINTAINER doop


https://blog.csdn.net/java060515/article/details/84388101

 % docker pull rancher/controller-43f0364ab2f6dab17267e80a1f6a4adc
Using default tag: latest
latest: Pulling from rancher/controller-43f0364ab2f6dab17267e80a1f6a4adc
e8d8785a314f: Already exists
45e913e4d7fc: Already exists
2ae9e9a9242e: Pull complete
Digest: sha256:e447f4b799d531b56e27941256f8e4419954c5dc4e0c13fd1b5b6685adc42a0d
Status: Downloaded newer image for rancher/controller-43f0364ab2f6dab17267e80a1f6a4adc:latest
docker.io/rancher/controller-43f0364ab2f6dab17267e80a1f6a4adc:latest

 % docker tag docker.io/rancher/controller-43f0364ab2f6dab17267e80a1f6a4adc:latest gcr.io/knative-releases/knative.dev/eventing/cmd/controller@sha256:14e565af0a741a0e34b139d9661555189972af8d53e837305f711a3f9025e188
refusing to create a tag with a digest reference



https://www.cnblogs.com/mathli/p/11006397.html


docker pull shixiongqi/activator-ecd51ca5034883acbe737fde417a3d86
Using default tag: latest
latest: Pulling from shixiongqi/activator-ecd51ca5034883acbe737fde417a3d86
2df365faf0e3: Pull complete 
aa91ba1b569d: Pull complete 
40a7a52a0b5b: Pull complete 
Digest: sha256:a1da9f52a48de84217b3c43f9854cdc13981a6a0d4d3bf16a363e7d7c7544f59
Status: Downloaded newer image for shixiongqi/activator-ecd51ca5034883acbe737fde417a3d86:latest
docker.io/shixiongqi/activator-ecd51ca5034883acbe737fde417a3d86:latest


kubectl -n knative-serving edit deploy activator set image docker.io/shixiongqi/activator-ecd51ca5034883acbe737fde417a3d86:latest


 % kubectl -n knative-serving describe pod activator-54dfd89cc7-8qxzz 
  Warning  Unhealthy  79s (x11 over 2m59s)  kubelet            Liveness probe failed: HTTP probe failed with statuscode: 500

https://stackoverflow.com/questions/47585198/readiness-probe-failed-http-probe-failed-with-statuscode-500-back-off-restarti

资源不够，修改cpu 内存
  Warning  Unhealthy    18m (x11 over 20m)   kubelet            Readiness probe failed: HTTP probe failed with statuscode: 500
  Warning  Unhealthy    10m (x41 over 20m)   kubelet            Liveness probe failed: HTTP probe failed with statuscode: 500
  Warning  Unhealthy    5m23s (x4 over 17m)  kubelet            Readiness probe failed: Get "http://10.1.1.49:8012/": dial tcp 10.1.1.49:8012: connect: connection refused
  Warning  FailedMount  99s (x3 over 102s)   kubelet            MountVolume.SetUp failed for volume "controller-token-c6rrs" : failed to sync secret cache: timed out waiting for the condition

 % kubectl -n knative-serving logs activator-54dfd89cc7-8qxzz 
  {"severity":"ERROR","timestamp":"2022-01-15T03:49:44.3424585Z","logger":"activator","caller":"websocket/connection.go:192","message":"Failed to send ping message to ws://autoscaler.knative-serving.svc.cluster.local:8080","commit":"0107066","knative.dev/controller":"activator","knative.dev/pod":"activator-54dfd89cc7-8qxzz","error":"connection has not yet been established","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func3\n\tknative.dev/pkg@v0.0.0-20210331065221-952fdd90dbb0/websocket/connection.go:192"}


% docker pull shixiongqi/autoscaler-hpa-85c0b68178743d74ff7f663a72802ceb
Using default tag: latest
latest: Pulling from shixiongqi/autoscaler-hpa-85c0b68178743d74ff7f663a72802ceb
2df365faf0e3: Already exists 
aa91ba1b569d: Already exists 
f8c1dbf530d6: Pull complete 
Digest: sha256:46d83f0832224d7e73cfa10d6f588a51aaaabd7c953d00b783de81fa42700f1a
Status: Downloaded newer image for shixiongqi/autoscaler-hpa-85c0b68178743d74ff7f663a72802ceb:latest
docker.io/shixiongqi/autoscaler-hpa-85c0b68178743d74ff7f663a72802ceb:latest


% docker pull shixiongqi/controller-f6fdb41c6acbc726e29a3104ff2ef720
Using default tag: latest
latest: Pulling from shixiongqi/controller-f6fdb41c6acbc726e29a3104ff2ef720
2df365faf0e3: Already exists
aa91ba1b569d: Already exists
91b6493845ca: Pull complete
Digest: sha256:f5bda3fa3c1d1f6f17fddc9df0bf2af4e838ea996f7dbff83a0b1a63b781dfd2
Status: Downloaded newer image for shixiongqi/controller-f6fdb41c6acbc726e29a3104ff2ef720:latest
docker.io/shixiongqi/controller-f6fdb41c6acbc726e29a3104ff2ef720:latest


 % docker pull shixiongqi/domain-mapping-webhook-a127ae3e896f4e4bc1179581011b7824
Using default tag: latest
latest: Pulling from shixiongqi/domain-mapping-webhook-a127ae3e896f4e4bc1179581011b7824
2df365faf0e3: Already exists
72164b581b02: Pull complete
1f0edaf6bf48: Pull complete
Digest: sha256:7c47e0666c1ceefddc4eaf5b8bb4a60901ace36182e926d9eb9ed8bd6aa91418
Status: Downloaded newer image for shixiongqi/domain-mapping-webhook-a127ae3e896f4e4bc1179581011b7824:latest
docker.io/shixiongqi/domain-mapping-webhook-a127ae3e896f4e4bc1179581011b7824:latest


% docker pull shixiongqi/domain-mapping-82f8626be89c35bcd6c666fd2fc8ccb7
Using default tag: latest
latest: Pulling from shixiongqi/domain-mapping-82f8626be89c35bcd6c666fd2fc8ccb7
2df365faf0e3: Already exists 
72164b581b02: Already exists 
591c5e6ceb7e: Pull complete 
Digest: sha256:91bbd1ebad711ba56b783eee9ce411deafd3bfab9580902b4b1b3999334aa05a
Status: Downloaded newer image for shixiongqi/domain-mapping-82f8626be89c35bcd6c666fd2fc8ccb7:latest
docker.io/shixiongqi/domain-mapping-82f8626be89c35bcd6c666fd2fc8ccb7:latest

% docker pull shixiongqi/webhook-261c6506fca17bc41be50b3461f98f1c
Using default tag: latest
latest: Pulling from shixiongqi/webhook-261c6506fca17bc41be50b3461f98f1c
2df365faf0e3: Already exists
aa91ba1b569d: Already exists
8787c80fea0b: Pull complete
Digest: sha256:2f56857b482f6640d75e3ea46cb2b655e6bcc46d280ce7e5a873777ecdec9071
Status: Downloaded newer image for shixiongqi/webhook-261c6506fca17bc41be50b3461f98f1c:latest
docker.io/shixiongqi/webhook-261c6506fca17bc41be50b3461f98f1c:latest




% kubectl -n knative-serving get pod
NAME                                    READY   STATUS    RESTARTS   AGE
activator-54dfd89cc7-h7vq7              0/1     Running   0          59s
autoscaler-958cd6b94-9lnf8              0/1     Running   0          49s
controller-758b55b9ff-lcc77             1/1     Running   0          7m39s
domain-mapping-84b6d958b9-qwnls         1/1     Running   0          4m13s
domainmapping-webhook-64f8868c6-68jws   1/1     Running   0          3m44s
webhook-664cd645b-gnv5t                 1/1     Running   0          2m56s


 % kubectl -n istio-system delete pod istio-egressgateway-776546bdc4-vng8k 
pod "istio-egressgateway-776546bdc4-vng8k" deleted

% kubectl -n istio-system delete pod istio-ingressgateway-77b69b4bf8-4wl4w 
pod "istio-ingressgateway-77b69b4bf8-4wl4w" deleted


 % docker pull shixiongqi/controller-f6fdb41c6acbc726e29a3104ff2ef720:latest
latest: Pulling from shixiongqi/controller-f6fdb41c6acbc726e29a3104ff2ef720
Digest: sha256:f5bda3fa3c1d1f6f17fddc9df0bf2af4e838ea996f7dbff83a0b1a63b781dfd2
Status: Image is up to date for shixiongqi/controller-f6fdb41c6acbc726e29a3104ff2ef720:latest
docker.io/shixiongqi/controller-f6fdb41c6acbc726e29a3104ff2ef720:latest



 % docker pull villardl/mtping-26ac4e6a49a610ffaac30cc0a8ab693a
Using default tag: latest
latest: Pulling from villardl/mtping-26ac4e6a49a610ffaac30cc0a8ab693a
2df365faf0e3: Already exists 
879d63de4636: Pull complete 
1f1ce3bf6452: Pull complete 
Digest: sha256:8f345da670a110ad6a58c1072bdf3fbf1a1797ff6fb6dad09b41948da87edeb7
Status: Downloaded newer image for villardl/mtping-26ac4e6a49a610ffaac30cc0a8ab693a:latest
docker.io/villardl/mtping-26ac4e6a49a610ffaac30cc0a8ab693a:latest


https://registry.hub.docker.com/u/linkinghack
没有x86的
docker pull linkinghack/knative-eventing-controller

https://registry.hub.docker.com/u/keveon
manifest unknown: manifest unknown
docker pull keveon/knative-eventing-webhook


https://registry.hub.docker.com/u/xukun94


https://registry.hub.docker.com/u/zhku

 % docker pull zhku/knative-eventing-webhook
Using default tag: latest
latest: Pulling from zhku/knative-eventing-webhook
b49b96595fd4: Pull complete 
3eb256afac60: Pull complete 
b81cb0847446: Pull complete 
Digest: sha256:425ab007c722276b15154e9cec8c54e2c1ec965c5289d901835a1a3864cb7eb9
Status: Downloaded newer image for zhku/knative-eventing-webhook:latest
docker.io/zhku/knative-eventing-webhook:latest

 % docker pull zhku/knative-eventing-mtping
Using default tag: latest
latest: Pulling from zhku/knative-eventing-mtping
b49b96595fd4: Already exists 
3eb256afac60: Already exists 
0be3843b7b85: Pull complete 
Digest: sha256:4174c04e94a567165702365092780dc50e9500a81b68ddbce396e4d549473411
Status: Downloaded newer image for zhku/knative-eventing-mtping:latest
docker.io/zhku/knative-eventing-mtping:latest

% docker pull zhku/knative-eventing-controller
Using default tag: latest
latest: Pulling from zhku/knative-eventing-controller
b49b96595fd4: Already exists
3eb256afac60: Already exists
5dffed433f11: Pull complete
Digest: sha256:4a133f0aa219d9f0070c98f22ef2f460b9de4d41ceaca29305cdbcba74d5e6c6
Status: Downloaded newer image for zhku/knative-eventing-controller:latest
docker.io/zhku/knative-eventing-controller:latest


 % kubectl -n knative-eventing get deploy
NAME                    READY   UP-TO-DATE   AVAILABLE   AGE
eventing-controller     1/1     1            1           23s
eventing-webhook        1/1     1            1           4m31s
pingsource-mt-adapter   0/0     0            0           75s


% docker pull fandy00001/knative-serving-activator
Using default tag: latest
latest: Pulling from fandy00001/knative-serving-activator
e59bd8947ac7: Already exists 
5fe40c1e3bff: Pulling fs layer 
322c9e5b077c: Download complete 
latest: Pulling from fandy00001/knative-serving-activator
e59bd8947ac7: Already exists 
5fe40c1e3bff: Pulling fs layer 
322c9e5b077c: Download complete 
latest: Pulling from fandy00001/knative-serving-activator
e59bd8947ac7: Already exists 
5fe40c1e3bff: Pull complete 
322c9e5b077c: Pull complete 
Digest: sha256:d10d3049c7847a4fb3d0d327a5cb9590e1a93f7594f5f0220cfac20e0a7eebc7
Status: Downloaded newer image for fandy00001/knative-serving-activator:latest
docker.io/fandy00001/knative-serving-activator:latest



 % docker pull xukun94/knative-serving-activator
Using default tag: latest
Error response from daemon: manifest for xukun94/knative-serving-activator:latest not found: manifest unknown: manifest unknown
xiazemin@xiazemindeMBP istio-1.12.1 % docker pull fandy00001/knative-serving-autoscaler
Using default tag: latest
latest: Pulling from fandy00001/knative-serving-autoscaler
e59bd8947ac7: Already exists
5fe40c1e3bff: Already exists
805e157618ba: Pulling fs layer
latest: Pulling from fandy00001/knative-serving-autoscaler
e59bd8947ac7: Already exists
5fe40c1e3bff: Already exists
805e157618ba: Pulling fs layer
latest: Pulling from fandy00001/knative-serving-autoscaler
e59bd8947ac7: Already exists
5fe40c1e3bff: Already exists
805e157618ba: Pull complete
Digest: sha256:47e37f4b751bddf9989fc246104a8b4da1ccbca2f673deb7293d7d352935099b
Status: Downloaded newer image for fandy00001/knative-serving-autoscaler:latest
docker.io/fandy00001/knative-serving-autoscaler:latest


 % kubectl -n knative-serving get pod   
NAME                                    READY   STATUS    RESTARTS   AGE
activator-7564d88cc4-6pk85              1/1     Running   0          87s
autoscaler-5b4898978d-5dt48             1/1     Running   0          36s
controller-758b55b9ff-lcc77             1/1     Running   0          133m
domain-mapping-84b6d958b9-qwnls         1/1     Running   0          129m
domainmapping-webhook-64f8868c6-68jws   1/1     Running   0          129m
webhook-664cd645b-gnv5t                 1/1     Running   0          128m


 % kubectl get KnativeServing knative-serving -n knative-serving
error: the server doesn't have a resource type "KnativeServing"


 % kubectl apply -f knative-serving/knative-serving.yaml 
namespace/knative-serving configured
error: unable to recognize "knative-serving/knative-serving.yaml": no matches for kind "KnativeServing" in version "operator.knative.dev/v1alpha1"

https://www.freesion.com/article/1151943953/

https://knative.dev/docs/install/operator/configuring-serving-cr/


apiVersion: operator.knative.dev/v1alpha1  => apiVersion: operator.knative.dev/v1

% kubectl apply -f knative-serving/knative-serving.yaml
namespace/knative-serving unchanged
error: unable to recognize "knative-serving/knative-serving.yaml": no matches for kind "KnativeServing" in version "operator.knative.dev/v1"


serving.knative.dev/v1
https://knative.dev/docs/serving/services/creating-services/


 % kubectl apply -f knative-serving/knative-serving.yaml
namespace/knative-serving unchanged
error: unable to recognize "knative-serving/knative-serving.yaml": no matches for kind "KnativeServing" in version "serving.knative.dev/v1"


https://knative.dev/docs/reference/api/serving-api/

% kubectl apply -f knative-serving/knative-serving.yaml
namespace/knative-serving unchanged
error: unable to recognize "knative-serving/knative-serving.yaml": no matches for kind "KnativeServing" in version "serving.knative.dev/v1alpha1"



https://knative.dev/docs/install/operator/knative-with-operators/
 % kubectl apply -f knative-eventing/knative-eventing.yaml 
namespace/knative-eventing configured
error: unable to recognize "knative-eventing/knative-eventing.yaml": no matches for kind "KnativeEventing" in version "operator.knative.dev/v1alpha1"



apiVersion: operator.knative.dev/v1alpha1
kind: KnativeServing
metadata:
  name: knative-serving
  namespace: knative-serving
spec:
  config:
    istio:
      local-gateway.knative-serving.knative-local-gateway: "knative-local-gateway.istio-system.svc.cluster.local"

https://cloud.tencent.com/developer/article/1470000

