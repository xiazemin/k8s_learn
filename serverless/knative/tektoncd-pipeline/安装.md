
https://github.com/knative/build
  Knative Build is deprecated in favor of Tekton Pipelines. There are no plans to produce future releases of this component.


https://github.com/tektoncd/pipeline

The Tekton Pipelines project provides k8s-style resources for declaring CI/CD-style pipelines.


https://github.com/tektoncd/pipeline/blob/main/docs/install.md
Run the following command to install Tekton Pipelines and its dependencies:

kubectl apply --filename https://storage.googleapis.com/tekton-releases/pipeline/latest/release.yaml
namespace/tekton-pipelines created
podsecuritypolicy.policy/tekton-pipelines created
clusterrole.rbac.authorization.k8s.io/tekton-pipelines-controller-cluster-access created
clusterrole.rbac.authorization.k8s.io/tekton-pipelines-controller-tenant-access created
clusterrole.rbac.authorization.k8s.io/tekton-pipelines-webhook-cluster-access created
role.rbac.authorization.k8s.io/tekton-pipelines-controller created
role.rbac.authorization.k8s.io/tekton-pipelines-webhook created
role.rbac.authorization.k8s.io/tekton-pipelines-leader-election created
role.rbac.authorization.k8s.io/tekton-pipelines-info created
serviceaccount/tekton-pipelines-controller created
serviceaccount/tekton-pipelines-webhook created
clusterrolebinding.rbac.authorization.k8s.io/tekton-pipelines-controller-cluster-access created
clusterrolebinding.rbac.authorization.k8s.io/tekton-pipelines-controller-tenant-access created
clusterrolebinding.rbac.authorization.k8s.io/tekton-pipelines-webhook-cluster-access created
rolebinding.rbac.authorization.k8s.io/tekton-pipelines-controller created
rolebinding.rbac.authorization.k8s.io/tekton-pipelines-webhook created
rolebinding.rbac.authorization.k8s.io/tekton-pipelines-controller-leaderelection created
rolebinding.rbac.authorization.k8s.io/tekton-pipelines-webhook-leaderelection created
rolebinding.rbac.authorization.k8s.io/tekton-pipelines-info created
customresourcedefinition.apiextensions.k8s.io/clustertasks.tekton.dev created
customresourcedefinition.apiextensions.k8s.io/conditions.tekton.dev created
customresourcedefinition.apiextensions.k8s.io/pipelines.tekton.dev created
customresourcedefinition.apiextensions.k8s.io/pipelineruns.tekton.dev created
customresourcedefinition.apiextensions.k8s.io/pipelineresources.tekton.dev created
customresourcedefinition.apiextensions.k8s.io/runs.tekton.dev created
customresourcedefinition.apiextensions.k8s.io/tasks.tekton.dev created
customresourcedefinition.apiextensions.k8s.io/taskruns.tekton.dev created
secret/webhook-certs created
validatingwebhookconfiguration.admissionregistration.k8s.io/validation.webhook.pipeline.tekton.dev created
mutatingwebhookconfiguration.admissionregistration.k8s.io/webhook.pipeline.tekton.dev created
validatingwebhookconfiguration.admissionregistration.k8s.io/config.webhook.pipeline.tekton.dev created
clusterrole.rbac.authorization.k8s.io/tekton-aggregate-edit created
clusterrole.rbac.authorization.k8s.io/tekton-aggregate-view created
configmap/config-artifact-bucket created
configmap/config-artifact-pvc created
configmap/config-defaults created
configmap/feature-flags created
configmap/pipelines-info created
configmap/config-leader-election created
configmap/config-logging created
configmap/config-observability created
configmap/config-registry-cert created
deployment.apps/tekton-pipelines-controller created
service/tekton-pipelines-controller created
horizontalpodautoscaler.autoscaling/tekton-pipelines-webhook created
deployment.apps/tekton-pipelines-webhook created
service/tekton-pipelines-webhook created


% kubectl -n tekton-pipelines get deploy
NAME                          READY   UP-TO-DATE   AVAILABLE   AGE
tekton-pipelines-controller   0/1     1            0           76s
tekton-pipelines-webhook      0/1     1            0           66s

Monitor the installation using the following command until all components show a Running status:

kubectl get pods --namespace tekton-pipelines --watch

https://blog.csdn.net/zhaopeng_yu/article/details/113865342
在Knative新版本中是由Tekton Pipelines来实现流水线构建功能，Tekton Pipelines是扩展K8s（CRD）来实现的，Knative Build组件是开放式的设计，各个组件之间是解耦的，在Knative中也可以使用Tekton Piplines的替代品等。

 % kubectl -n tekton-pipelines  get deploy tekton-pipelines-controller -o yaml >tektoncd-pipeline/tekton-pipelines-controller.yaml
  % kubectl -n tekton-pipelines  get deploy tekton-pipelines-webhook -o yaml > tektoncd-pipeline/tekton-pipelines-webhook.yaml


  gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/controller:v0.32.0@sha256:0e4f92e95c9ae8140ddfc8751bb54cf54e1b00d27aa542c11d5ad8663c5067ae

  gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/webhook:v0.32.0@sha256:f0e31a5b1218bef6ad6323c05b4ed54412555accf542ac8a9dd0221629f33189


  % docker pull aisuko/tektoncd-pipeline-cmd-webhook
Using default tag: latest
latest: Pulling from aisuko/tektoncd-pipeline-cmd-webhook
4e1edcbff92b: Pull complete 
634f9ea302f8: Pull complete 
e9dfadf953c7: Pull complete 
Digest: sha256:c94ee1bffbf0a5a57eaf3e796b232468d74b55826e415b4711a9d98809a42ca2
Status: Downloaded newer image for aisuko/tektoncd-pipeline-cmd-webhook:latest
docker.io/aisuko/tektoncd-pipeline-cmd-webhook:latest


% docker pull aisuko/tektoncd-pipeline-cmd-controller
Using default tag: latest
latest: Pulling from aisuko/tektoncd-pipeline-cmd-controller
4e1edcbff92b: Pull complete
634f9ea302f8: Pull complete
f6ad426155a0: Pull complete
Digest: sha256:cd09df75472ce39dda966a84121e61287fd807ef7342c8fbd82e2df4ddfdd2bc
Status: Downloaded newer image for aisuko/tektoncd-pipeline-cmd-controller:latest
docker.io/aisuko/tektoncd-pipeline-cmd-controller:latest


% kubectl -n tekton-pipelines describe pod tekton-pipelines-controller-6f6f744dbf-cxrth 
  Warning  BackOff    1s (x11 over 78s)  kubelet            Back-off restarting failed container

 % kubectl -n tekton-pipelines logs tekton-pipelines-webhook-86864b69c7-d7kr6 
2022/01/15 13:46:18 Error loading logging configuration: lstat /etc/config-logging: no such file or directory



 % docker pull dyrnq/tektoncd-pipeline-cmd-webhook
Using default tag: latest
latest: Pulling from dyrnq/tektoncd-pipeline-cmd-webhook
2df365faf0e3: Already exists
50c0a8a0d5d4: Pull complete
777fe91632fa: Pull complete
Digest: sha256:f0e31a5b1218bef6ad6323c05b4ed54412555accf542ac8a9dd0221629f33189
Status: Downloaded newer image for dyrnq/tektoncd-pipeline-cmd-webhook:latest
docker.io/dyrnq/tektoncd-pipeline-cmd-webhook:latest


 % docker pull dyrnq/tektoncd-pipeline-cmd-controller
Using default tag: latest
latest: Pulling from dyrnq/tektoncd-pipeline-cmd-controller
2df365faf0e3: Already exists 
50c0a8a0d5d4: Pull complete 
60f4cd633772: Pull complete 
Digest: sha256:0e4f92e95c9ae8140ddfc8751bb54cf54e1b00d27aa542c11d5ad8663c5067ae
Status: Downloaded newer image for dyrnq/tektoncd-pipeline-cmd-controller:latest
docker.io/dyrnq/tektoncd-pipeline-cmd-controller:latest


 % kubectl -n tekton-pipelines logs tekton-pipelines-controller-8f6f4868c-mknq5 
2022/01/15 13:53:28 Registering 7 clients
2022/01/15 13:53:28 Registering 5 informer factories
2022/01/15 13:53:28 Registering 8 informers
2022/01/15 13:53:28 Registering 2 controllers
2022/01/15 13:53:28 Readiness and health check server listening on port 8080
{"level":"info","ts":"2022-01-15T13:53:28.634Z","caller":"logging/config.go:116","msg":"Successfully created the logger."}
{"level":"info","ts":"2022-01-15T13:53:28.635Z","caller":"logging/config.go:117","msg":"Logging level set to: info"}
{"level":"info","ts":"2022-01-15T13:53:28.636Z","logger":"tekton-pipelines-controller","caller":"profiling/server.go:64","msg":"Profiling enabled: false","commit":"1401ab7"}
{"level":"fatal","ts":"2022-01-15T13:53:28.647Z","logger":"tekton-pipelines-controller","caller":"sharedmain/main.go:313","msg":"Version check failed","commit":"1401ab7","error":"kubernetes version \"1.19.7\" is not compatible, need at least \"1.20.0-0\" (this can be overridden with the env var \"KUBERNETES_MIN_VERSION\")","stacktrace":"github.com/tektoncd/pipeline/vendor/knative.dev/pkg/injection/sharedmain.CheckK8sClientMinimumVersionOrDie\n\tgithub.com/tektoncd/pipeline/vendor/knative.dev/pkg/injection/sharedmain/main.go:313\ngithub.com/tektoncd/pipeline/vendor/knative.dev/pkg/injection/sharedmain.MainWithConfig\n\tgithub.com/tektoncd/pipeline/vendor/knative.dev/pkg/injection/sharedmain/main.go:217\nmain.main\n\tgithub.com/tektoncd/pipeline/cmd/controller/main.go:102\nruntime.main\n\truntime/proc.go:225"}

版本太新了

Error response from daemon: manifest for cnhub/tektoncd.pipeline.cmd.webhook:latest not found: manifest unknown: manifest unknown

https://blog.csdn.net/rocky_gjm/article/details/86075091


kubectl apply -f https://storage.googleapis.com/tekton-releases/pipeline/previous/v0.30.0/release.yaml

docker pull rancher/tektoncd-controller

https://blog.csdn.net/u013276277/article/details/106163728


https://blog.csdn.net/zhaopeng_yu/article/details/113865342

https://www.servicemesher.com/getting-started-with-knative/build.html
